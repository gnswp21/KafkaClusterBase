services:
  mykafka1:
    image: mykafka
    container_name: mykafka1
    networks:
      KafkaClusterPractice:
    ports:
      - 9092:9092
    environment:
      KAFKA_LISTENERS: PLAINTEXT://:9092,CONTROLLER://:9093,EXTERNAL://:9094
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://mykafka1:9092,EXTERNAL://43.203.166.170:9092
    volumes:
      - zookeeper_data_1:/root/kafka/zookeeper
      - kafka_data_1:/root/kafka/data
      - kafka_log_1:/root/kafka/logs
    command: [ "sh", "-c", "service ssh start; tail -f /dev/null" ]
  mykafka2:
    image: mykafka
    container_name: mykafka2
    networks:
      KafkaClusterPractice:
    environment:
      KAFKA_LISTENERS: PLAINTEXT://:9092,CONTROLLER://:9093,EXTERNAL://:9094
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://mykafka2:9092,EXTERNAL://43.203.166.170:9092
    volumes:
      - zookeeper_data_2:/root/kafka/zookeeper
      - kafka_data_2:/root/kafka/data
      - kafka_log_2:/root/kafka/logs
    command: [ "sh", "-c", "service ssh start; tail -f /dev/null" ]
  mykafka3:
    image: mykafka
    container_name: mykafka3
    networks:
      KafkaClusterPractice:
    environment:
      KAFKA_LISTENERS: PLAINTEXT://:9092,CONTROLLER://:9093,EXTERNAL://:9094
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://mykafka3:9092,EXTERNAL://43.203.166.170:9092
    volumes:
      - zookeeper_data_3:/root/kafka/zookeeper
      - kafka_data_3:/root/kafka/data
      - kafka_log_3:/root/kafka/logs
    command: [ "sh", "-c", "service ssh start; tail -f /dev/null" ]

volumes:
  zookeeper_data_1:
  kafka_data_1:
  kafka_log_1:
  zookeeper_data_2:
  kafka_data_2:
  kafka_log_2:
  zookeeper_data_3:
  kafka_data_3:
  kafka_log_3:


networks:
  KafkaClusterPractice: